import{v as d,n as e,m as y,W as b,J as j,c as v,a as f,b as N,u as m,t as w,O as _}from"./index-Cm1hfW9n.js";const k=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],S=y("shield-alert",k),A={js_error:m,unhandled_rejection:m,auth_error:N,network_error:f,devtools_open:v},L=a=>a==="auth_error"?{label:"High",color:"bg-red-100 text-red-700"}:a==="network_error"?{label:"Medium",color:"bg-yellow-100 text-yellow-700"}:a==="devtools_open"?{label:"Low",color:"bg-blue-100 text-blue-700"}:{label:"Medium",color:"bg-yellow-100 text-yellow-700"};function J(){const[a,x]=d.useState([]),[c,h]=d.useState("all");d.useEffect(()=>{let t=!1;const n=async()=>{try{const s=await fetch("/fda/backend-php/api/security/events");if(s.ok){const r=await s.json();!t&&Array.isArray(r==null?void 0:r.events)&&x(r.events);return}}catch{}try{const s=JSON.parse(localStorage.getItem("sec_events")||"[]");!t&&Array.isArray(s)&&x(s)}catch{}};n();const o=setInterval(n,8e3);return()=>{t=!0,clearInterval(o)}},[]);const i=d.useMemo(()=>c==="all"?a:a.filter(t=>t.type===c),[a,c]),p=()=>{const t=["Time","Type","URL","UserAgent","Detail"],n=i.map(l=>[l.ts,l.type,l.url,l.ua,JSON.stringify(l.detail)]),o=[t.join(","),...n.map(l=>l.map(u=>`"${String(u).replace(/"/g,'""')}"`).join(","))].join(`
`),s=new Blob([o],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download=`security_events_${new Date().toISOString().split("T")[0]}.csv`,r.click()},g=["all","js_error","unhandled_rejection","auth_error","network_error","devtools_open"];return e.jsxs("div",{className:"bg-gradient-to-br from-red-900/40 to-yellow-900/40 backdrop-blur-xl rounded-3xl p-8 border-2 border-red-500/30 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(S,{className:"w-8 h-8 text-red-400"}),e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Security Center"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4 text-white"}),e.jsx("select",{value:c,onChange:t=>h(t.target.value),className:"px-3 py-2 rounded-lg bg-white/90 text-gray-900 font-semibold",children:g.map(t=>e.jsx("option",{value:t,children:t.replace("_"," ")},t))})]}),e.jsxs("button",{onClick:p,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"})," Export CSV"]}),e.jsxs("span",{className:"text-white/80",children:[i.length," events"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 max-h-[60vh] overflow-y-auto pr-2",children:[i.length===0&&e.jsx("div",{className:"text-white/80",children:"No security events recorded."}),i.map((t,n)=>{const o=A[t.type]||w,s=L(t.type);return e.jsxs(_.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white/95 rounded-xl p-4 shadow border border-white/40",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 text-red-600 flex items-center justify-center",children:e.jsx(o,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-900",children:t.type.replace("_"," ")}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.ts).toLocaleString()})]})]}),e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-bold ${s.color}`,children:s.label})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"text-gray-700 break-all",children:[e.jsx("span",{className:"font-semibold",children:"URL:"})," ",t.url]}),e.jsxs("div",{className:"text-gray-700 break-all md:col-span-2",children:[e.jsx("span",{className:"font-semibold",children:"Detail:"})," ",JSON.stringify(t.detail)]})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 break-all",children:[e.jsx("span",{className:"font-semibold",children:"User Agent:"})," ",t.ua]})]},n)})]})]})}export{J as default};
